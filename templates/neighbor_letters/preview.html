{% extends "base.html" %}

{% block title %}Preview Letter{% endblock %}

{% block content %}
<div class="mclemore-container">
    <h1 class="mclemore-title">Preview Letter</h1>
    <h3 class="mclemore-subtitle">Auction: {{ auction_code }}</h3>

    <div class="row">
        <div class="col-md-6">
            <div class="mclemore-card">
                <div class="mclemore-card-header">
                    <h4 class="mclemore-subtitle mb-0">Auction Details</h4>
                </div>
                <div class="mclemore-card-body">
                    <p><strong>Title:</strong> {{ auction.title }}</p>
                    <p><strong>Location:</strong> {{ auction.location }}</p>
                    <p><strong>Date:</strong> {{ auction.date }}</p>
                    <p><strong>Time:</strong> {{ auction.time }}</p>
                    {% if auction.description %}
                    <p><strong>Description:</strong> {{ auction.description }}</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <div class="row mt-4">
        <div class="col-12">
            <div class="mclemore-card">
                <div class="mclemore-card-header">
                    <h4 class="mclemore-subtitle mb-0">Letter Preview</h4>
                </div>
                <div class="mclemore-card-body">
                    {% if sample_addresses %}
                        {% for address in sample_addresses %}
                            <div class="preview-container mb-4">
                                <h5>Preview for {{ address.name }}</h5>
                                <div class="letter-preview">
                                    {{ template
                                        | replace('{{name}}', address.name)
                                        | replace('{{auction_title}}', auction.title)
                                        | replace('{{auction_date}}', auction.date)
                                        | replace('{{auction_time}}', auction.time)
                                        | replace('{{auction_location}}', auction.location)
                                        | replace('{{address_line1}}', address.address_line1)
                                        | replace('{{address_city}}', address.address_city)
                                        | replace('{{address_state}}', address.address_state)
                                        | replace('{{address_zip}}', address.address_zip)
                                        | safe
                                    }}
                                </div>
                            </div>
                        {% endfor %}
                    {% else %}
                        <p>No sample addresses available for preview. Please upload addresses first.</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}